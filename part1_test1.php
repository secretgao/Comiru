<?php

function stockDays($prices) {
    $n = count($prices);
    $res = array_fill(0, $n, 0);
    $stack = []; // 单调栈（存索引）

    for ($i = 0; $i < $n; $i++) {
        while (!empty($stack) && $prices[$i] > $prices[end($stack)]) {
            $prevIndex = array_pop($stack);
            $res[$prevIndex] = $i - $prevIndex;
        }
        $stack[] = $i;
    }
    return $res;
}

$prices = [30, 58, 32, 41, 35, 36, 54, 44];
echo '<pre>';
print_r(stockDays($prices));
// 结果
Array
(
    [0] => 1
    [1] => 0
    [2] => 1
    [3] => 3
    [4] => 1
    [5] => 1
    [6] => 0
    [7] => 0
)

$prices2 = [30, 32, 35, 32, 34, 36, 33, 39, 38, 31, 32, 62, 55, 45, 56, 78, 53, 63, 34, 73, 
55, 47, 83, 59, 43, 68, 53, 63, 54, 66, 78, 68, 87, 33, 59, 30, 89, 31, 45, 33, 54, 65, 
78, 44, 67, 76, 78, 99, 43, 54, 67, 77, 35, 34];
echo '<pre>';
print_r(stockDays($prices2));
// 结果
Array
(
    [0] => 1
    [1] => 1
    [2] => 3
    [3] => 1
    [4] => 1
    [5] => 2
    [6] => 1
    [7] => 4
    [8] => 3
    [9] => 1
    [10] => 1
    [11] => 4
    [12] => 2
    [13] => 1
    [14] => 1
    [15] => 7
    [16] => 1
    [17] => 2
    [18] => 1
    [19] => 3
    [20] => 2
    [21] => 1
    [22] => 10
    [23] => 2
    [24] => 1
    [25] => 5
    [26] => 1
    [27] => 2
    [28] => 1
    [29] => 1
    [30] => 2
    [31] => 1
    [32] => 4
    [33] => 1
    [34] => 2
    [35] => 1
    [36] => 11
    [37] => 1
    [38] => 2
    [39] => 1
    [40] => 1
    [41] => 1
    [42] => 5
    [43] => 1
    [44] => 1
    [45] => 1
    [46] => 1
    [47] => 0
    [48] => 1
    [49] => 1
    [50] => 1
    [51] => 0
    [52] => 0
    [53] => 0
)
 
